---
layout: post
title: Project - Chile Protests
---

## 2019-20 Chile Protests

### What Happened: 
- Modest hike in subway fare (around 4%) in Santiago in October 2019
- Started as a student led protest the week of October 14
  - By late October, over 1 million people protesting in the streets of Santiago (the largest protests in Chilean history)
  - Protests quickly spread across the country
  - The President deployed the military
- No single leader or cause
- Protests have resulted in thousands of injuries and over 30 deaths
- Key focus areas seem to be high levels of income inequality and the cost of services, such as healthcare and education, that were privatized during the Pinochet dictatorship
- The government was caught off guard by the protests—just days before, President Piñera was quoted saying Chile was an **oasis of calm** among its Latin American neighbors

### Current Status:
- President Piñera promised a package of reforms in late October that did little to slow the protests
  - Many Cabinet members were dismissed
  - Lowest pensions and the min wage were increased
  - The subway fare hike along with a proposed hike in electricity prices were cancelled
  - A new, higher tax bracket was introduced for the wealthiest Chileans
  - Salary cuts for members of Congress
- The government at first resisted calls for a constitutional referendum, but then conceded
  - Constitutional referendum postponed from April until October 25, 2020
 - **Current status of protests: ongoing**

### Key Questions: 
  > - Chile is often called Latin America's Poster Child due to its neoliberal economic model, rapid economic growth, *relative* government stability, and low levels of absolute poverty.
  > - So why did mass protests break out across the country over a small rise in the cost of a metro ticket in Santiago?
  > - Could data have been used to "predict" or anticipate this crisis?
  > - Is this a "revolution of rising expectations"?  

### Methods:
For this project, I simply wanted to explore the available data using new tools and techniques learned in this class, including Git, Python, and R.

#### Part A: Visualization of Macro Data
###### Goal: 
Exploratory data analysis to
- Determine if there are any expected or unexpected relationships between the variables that should be explored further
- Develop time series model to analyze the relationship (if any) between copper prices and protest activity (in progress)
  
  - Role of Fiscal Stabilizer: Given Chile’s reliance on natural resource (copper) exports, do commodity prices impact government spending on social programs?
  - Does reduced government spending on social programs lead to an increase in protest activity?

###### Data Collection: 
Data was collected using APIs and corresponding R packages, when available.  The following chart summarizes the data collected for this project, including the source and API or non-API method.  R code for accessing the APIs is below.

|Data     |    Source   |     Database |     API |R package|     R name|
| :---:      | :---:      |:---------:       |:---:      |:---:        |:---:      |
| GDP per capita, constant 2010 US$      | World Bank |World Development Indicators      |Yes       |WDI       |gdp.pc|
| Gini coefficient      | World Bank |World Development Indicators      |Yes       |WDI      |gini|
| Palma Ratio*     | World Bank |World Development Indicators      |Yes       |WDI       |palma|
| Central government debt, total (% of GDP)     | World Bank |World Development Indicators      |Yes       |WDI       |debt|
| Educational attainment, at least completed short-cycle tertiary (population 25+, total %)     | World Bank |World Development Indicators      |Yes      |WDI        |uni|
| Copper, ($/mt)      | World Bank |Commodities Markets "Pink Sheet" Data      |No       |N/A       |avg_cu_price|
| Social Spending, Public (% of GDP)     | OECD |Social Expenditure Database      |No*       |N/A       |social_exp|
| Pension Spending, Public (% of GDP)     | OECD |Social Expenditure Database      |No*      |N/A        |pension_exp|
| Public Unemployement Spending, Total (% of GDP)     | OECD |Social Expenditure Database      |No*      |N/A       |unemp_exp|
| General Government Deficit, Total (% of GDP)     | OECD |National Accounts at a Glance      |Yes      |OECD        |deficit|
| Mass Mobilization Protest Data    | Binghamton University |Harvard Dataverse      |No      |N/A       |protest_count|
| Twitter Data     | Twitter |N/A      |Yes      |rtweet        |N/A|

The R code to access the API data is below.
        
        ## World Bank API
        library(WDI)

        wdi.data = WDI(
          country = "CL",
          indicator = c("gini" = "SI.POV.GINI", "top10" = "SI.DST.10TH.10", 
                        "bottom20" = "SI.DST.FRST.20", "bottom10" = "SI.DST.FRST.10", "second20" = "SI.DST.02ND.20", "gdp.pc" = "NY.GDP.PCAP.KD",
                        "gov.uni" = "SE.XPD.TERT.ZS", "uni" = "SE.TER.CUAT.ST.ZS", "debt" = "GC.DOD.TOTL.GD.ZS"),
          start = 1970,
          end = 2020,
          extra = FALSE,
          cache = NULL)

        ## OECD API

        library(OECD)

        #see list of available datasets
        available_datasets_df <- get_datasets()

        #search for keyword in dataset
        as.data.frame(search_dataset("deficit"))

        deficit <- "SNA_TABLE12"
        filter_list <- list("CHL")
        def <- get_dataset(dataset = deficit, filter = filter_list)
        head(def)  

###### Methods: 
The R packages tidyverse/dpylr were used extensively to select, filter, and mutate variables, and join the various datasets into a single data frame for analysis.  This process was more challenging than expected, and more work should be done to further visualize the data.  The R code for data cleaning and transformation is below.


        ##Filter and transform the data

        protest_chl <- dplyr::filter(protest, country=="Chile")

        protest_chl <- protest_chl %>%
          group_by(year) %>%
          summarize(protest_count = sum(protest))

        copper <- dplyr::select(commodity, year, Copper)

        copper <- copper %>%
          group_by(year) %>%
          summarize(avg_price = mean(Copper))

        wdiedit <- wdi.data %>%
          mutate(palma = top10 / (bottom20 + second20))

        names(def)[names(def) == "obsTime"] <- "year"

        names(oecd)[names(oecd) == "TIME"] <- "year"

        social_spend <- dplyr::filter(oecd, LOCATION=="CHL", INDICATOR=="SOCEXP", SUBJECT=="PUB", MEASURE=="PC_GDP")
        social_spend <-select(social_spend, year, Value)
        names(social_spend)[names(social_spend) == "Value"] <- "social_exp"

        pension_spend <- dplyr::filter(oecd, LOCATION=="CHL", INDICATOR=="PENSIONEXP", SUBJECT=="PUB", MEASURE=="PC_GDP")
        pension_spend <-select(pension_spend, year, Value)
        names(pension_spend)[names(pension_spend) == "Value"] <- "pension_exp"

        unemp_spend <- dplyr::filter(oecd, LOCATION=="CHL", INDICATOR=="PUBUNEMPEXP", SUBJECT=="TOT", MEASURE=="PC_GDP")
        unemp_spend <- select(unemp_spend, year, Value)
        names(unemp_spend)[names(unemp_spend) == "Value"] <- "unemp_exp"

        govdef <- dplyr::filter(deficit, LOCATION=="CHL")
        names(govdef)[names(govdef) == "TIME"] <- "year"
        names(govdef)[names(govdef) == "Value"] <- "deficit"
        govdef <- dplyr::select(govdef, year, deficit)

        wdi <- dplyr::select(wdiedit, year, gini, top10, bottom20, bottom10, second20, gdp.pc, gov.uni, uni, debt, palma)

        names(copper)[names(copper) == "avg_price"] <- "avg_cu_price"
        copper[, 1:ncol(copper)] <- lapply(1:ncol(copper), function(x) as.numeric(copper[[x]]))

        ## Merge datasets

        chl_data <- dplyr::full_join(social_spend, pension_spend, by = "year")
        chl_data <- dplyr::full_join(chl_data, unemp_spend, by = "year")
        chl_data <- dplyr::full_join(chl_data, protest_chl, by = "year")
        chl_data <- dplyr::full_join(chl_data, govdef, by = "year")
        chl_data <- dplyr::full_join(chl_data, wdi, by = "year")
        chl_data <- dplyr::full_join(chl_data, copper, by = "year") 


The R packages ggplot2 and patchwork were used for data visualization.  Below each image is the corresponding R script.

#### Visualization 1: GDP per Capita
*Chile's Economic Miracle*
- Looking from the outside, the neoliberalism model developed by **The Chicago Boys** under Pinochet appears to be successful
- Chile is one of the wealthiest countries in Latin America in terms of per capita GDP and is a member of the OECD

![GDP](/images/gdppc.PNG)

- 1982 Debt Crisis in Chile: unemployement rose to >20%
- Rising commodity prices helped facilitate a quick recovery from the 2007-08 Financial Crisis
![GDP](/images/copper.PNG)

- Some journalists have said the protests that spread across Latin America had one thing in common: commodity boom/bust cycle
  - Not immediately clear from the data (possible lag)
  - However, Chile appears to have escaped the resource curse
- Chile is highly dependent on both natural resource exports and demand from China
  - Top export: copper
  - China is Chile’s largest trading partner by a wide margin (33.5% of Chile’s exports vs. the no. 2 partner US at 13.8% according to the WITS)
- Austerity measures were implemented in 2018, reportedly to lower the federal government deficit after Piñera’s government took office that year
- Pederson (2019): Chile’s fiscal “structural surplus rule” takes into account future copper price expectations and limits macro volatility

        ##Sample code for GDP graph
        ggplot(data = chl_data, aes(x = year, y = gdp.pc)) + geom_point() + geom_smooth(method = "lm") = ggtitle("GDP per Capita")
        
#### Visualization 2: Inequality
*Many Chileans feel that the "economic miracle" has only benefitted the rich*
- High and persistent income inequality and very high cost of living
- Improvements in inequality have begun to slow over the last decade

![Gini](/images/gdpgini.PNG)
![Palma](/images/gdppalma.PNG)
![Palma2](/images/gdppalma2.PNG)

- From the charts above, we can see that inequality has improved, although Chile remains the most unequal country in the OECD
  - Gini Coefficient: most common measure of inequality, from 0-100
  - Palma Ratio: newer measure, defined as income share held by the highest 10% of the population / income share of the bottom 40%
 
![Social](/images/social.PNG)
![Pension](/images/pension.PNG)

- Lopez and Miller (2008): Low tax revenues result in low fiscal expenditures that limit investment in human capital
  - OECD (2020): Net tax rate for Chile 7% vs. 15% OECD average
  - “Tax wedge”: 7% for Chile vs. 36% OECD average

        #Sample code
        library(patchwork)
        library(hrbrthemes)
       
         f1 <- ggplot(data = chl_data, aes(x = year, y = gdp.pc)) +
              geom_line(color="blue",size=1) +
              ggtitle("GDP Per Capita") +
              theme_ipsum()

        f2 <- ggplot(data = chl_data, aes(x = year, y = palma)) +
          geom_line(color="red",size=1) +
          ggtitle("Palma Ratio") +
          theme_ipsum()

        f1 + f2

#### Visualization 3: Role of Chile's Students - Protest Culture?
*Chile’s students are well organized and have a long history of protesting, often successfully*
- 1980s: schools decentralized and/or privatized under Pinochet
- 2006: “Penguin Revolution” – school exam fees, bus fares, general inequality in the education system
- 2011: Chile Education Conflict
  - Utman (2019): Chile’s liberal democracy encourages grassroots participation
  - Many feel education is prohibitively expensive after Pinochet’s reforms
  - Pavlic (2020) found that increased access to college increases the frequency of protests
- Youth unemployment rising faster than overall unemployment
- Social media use and role in spread of protests (Twitter analysis in process)

![Protests](/images/protests.PNG)

- Justino and Martorano (2019): Association between protest participation and “strong individual preferences for redistribution”
  - Motivations: low quality of institutions and government services, corruption, perceived lower standards of living
- Mosley (2018): Civil engagement has increased due to economic growth and tech advances; as a result of this and “dysfunctional political institutions”, protests have become increasingly radical/widespread

#### Part B: Twitter Data Analysis (In Progress)
###### Goal: 
Explore Twitter data from 3 key time periods to see how the key topics and sentiment has changed over time: 
- 2019 pre-protest
- Late October 2019 at the height of the protests
- Now

###### Data Selection: 
Because geographic data is limited by Twitter's privacy policies, I chose to evaluate mentions: @sebastianpinera, which is the Twitter account of Chile's President Sebastian Pinera; along with the boolean search, Chile AND inequality

###### Data Collection:
Data was collected using both the API and non-API method. 
- The python package GetOldTweets3 was used to source historical tweets, as Twitter's official API only allows you to scrape tweets from the last 7 days
  - Many issues exporting csv files; Google Collab seemed to work better until I received the error, "too many requests"
  - Need to narrow down my search; in progress
  - For now, I sourced a sample of tweets for a 6 month period before the protests
- For tweets within the last week, the R package rtweet was used.

The python and R codes are below.

###### R: 

        ##Load packages required for analysis

        library(rtweet)
        library(tidyverse)
        library(ggplot2)
        library(ggraph)
        library(translateR)
        library(igraph)
        library(wordcloud)
        library(data.table)

        ##Create Twitter API token

        token <- rtweet::create_token(
          app = "Advanced Data Programming",
          consumer_key <- "xxxxx",
          consumer_secret <- "xxxxx",
          access_token <- "xxxxx",
          access_secret <- "xxxxx")

        ##Search tweets for replies to Sebastian Pinera; ignore retweets

        pinera <- rtweet::search_tweets("@sebastianpinera", n = 10000, include_rts = FALSE, retryonratelimit = TRUE)
        save_as_csv(pinera, "pinera20.csv", prepend_ids = TRUE, na = "", fileEncoding = "UTF-8")

        ##Search tweets for Chile and inequality; ignore retweets

        i.tweet <- rtweet::search_tweets("chile AND desigualdad", n = 10000, include_rts = FALSE, retryonratelimit = TRUE)
        save_as_csv(i.tweet, "inequalitytweets.csv", prepend_ids = TRUE, na = "", fileEncoding = "UTF-8")

###### Python code in CMD: 
      --querysearch "sebastianpinera" --since 2019-MM-DD --until 2019-MM-DD --maxtweets 10000 --output pinera_month.csv

###### Methods: 
The historical twitter data was loaded in R.  The packages ggplot2, wordcloud, and igraph will be used to analyze and visualize the data.

Link to the data:

[Pinera](http://hughes-hannah.github.io/pineratweets.csv)

### Future research: 
Because I am considering this as a potential dissertation topic, I plan to a) further develop the time series model and b) continue to collect rtweet data each week.
